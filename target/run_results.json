{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.13", "generated_at": "2024-04-22T16:22:17.910624Z", "invocation_id": "66d30ded-b605-4c83-9829-475d0e29e48c", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-22T16:22:17.167908Z", "completed_at": "2024-04-22T16:22:17.181462Z"}, {"name": "execute", "started_at": "2024-04-22T16:22:17.183644Z", "completed_at": "2024-04-22T16:22:17.383883Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.22009682655334473, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.northwind_project.customer_orders", "compiled": true, "compiled_code": "WITH customer_orders AS (\n  SELECT\n    o.order_id,    \n    c.customer_id,\n    c.company_name,\n    COUNT(od.product_id) AS num_products_ordered,\n    SUM(od.unit_price * od.quantity * (1 - od.discount)) AS total_order_amount\n  FROM\n    \"postgres\".\"public\".\"orders\" o\n    JOIN \"postgres\".\"public\".\"customers\" c ON o.customer_id = c.customer_id\n    LEFT JOIN \"postgres\".\"public\".\"order_details\" od ON o.order_id = od.order_id\n  GROUP BY\n    o.order_id, c.customer_id, c.company_name\n)\n\nSELECT *\nFROM customer_orders", "relation_name": "\"postgres\".\"public\".\"customer_orders\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-22T16:22:17.391784Z", "completed_at": "2024-04-22T16:22:17.397564Z"}, {"name": "execute", "started_at": "2024-04-22T16:22:17.400211Z", "completed_at": "2024-04-22T16:22:17.513841Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1256093978881836, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.northwind_project.customer_segmentation", "compiled": true, "compiled_code": "WITH customer_segmentation AS (\n  SELECT\n    c.customer_id,\n    c.company_name,\n    COUNT(o.order_id) AS num_orders,\n    SUM(od.unit_price * od.quantity * (1 - od.discount)) AS total_spent\n  FROM\n    \"postgres\".\"public\".\"customers\" c\n    LEFT JOIN \"postgres\".\"public\".\"orders\" o ON c.customer_id = o.customer_id\n    LEFT JOIN \"postgres\".\"public\".\"order_details\" od ON o.order_id = od.order_id\n  GROUP BY\n    c.customer_id, c.company_name\n)\n\nSELECT *,\n  CASE\n    WHEN num_orders >= 10 AND total_spent >= 1000 THEN 'High Value'\n    WHEN num_orders >= 5 THEN 'Mid Value'\n    ELSE 'Low Value'\n  END AS customer_segment\nFROM customer_segmentation", "relation_name": "\"postgres\".\"public\".\"customer_segmentation\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-22T16:22:17.521547Z", "completed_at": "2024-04-22T16:22:17.527229Z"}, {"name": "execute", "started_at": "2024-04-22T16:22:17.528897Z", "completed_at": "2024-04-22T16:22:17.642979Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.12521672248840332, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.northwind_project.product_sales", "compiled": true, "compiled_code": "WITH product_sales AS (\n  SELECT\n    p.product_id,\n    p.product_name,\n    COUNT(od.order_id) AS num_orders,\n    SUM(od.unit_price * od.quantity * (1 - od.discount)) AS total_sales\n  FROM\n    \"postgres\".\"public\".\"products\" p\n    LEFT JOIN \"postgres\".\"public\".\"order_details\" od ON p.product_id = od.product_id\n  GROUP BY\n    p.product_id, p.product_name\n)\n\nSELECT *\nFROM product_sales", "relation_name": "\"postgres\".\"public\".\"product_sales\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-22T16:22:17.651755Z", "completed_at": "2024-04-22T16:22:17.657963Z"}, {"name": "execute", "started_at": "2024-04-22T16:22:17.660242Z", "completed_at": "2024-04-22T16:22:17.833657Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.18564653396606445, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.northwind_project.revenue_by_region", "compiled": true, "compiled_code": "WITH revenue_by_region AS (\n  SELECT\n    o.ship_region,\n    COUNT(o.order_id) AS num_orders,\n    SUM(od.unit_price * od.quantity * (1 - od.discount)) AS total_sales\n  FROM\n    \"postgres\".\"public\".\"orders\" o\n    LEFT JOIN \"postgres\".\"public\".\"order_details\" od ON o.order_id = od.order_id\n  GROUP BY\n    o.ship_region\n)\n\nSELECT *\nFROM revenue_by_region", "relation_name": "\"postgres\".\"public\".\"revenue_by_region\""}], "elapsed_time": 1.0305159091949463, "args": {"defer": false, "exclude": [], "partial_parse_file_diff": true, "indirect_selection": "eager", "log_level_file": "debug", "strict_mode": false, "send_anonymous_usage_stats": true, "favor_state": false, "print": true, "use_colors_file": true, "version_check": true, "which": "run", "warn_error_options": {"include": [], "exclude": []}, "log_format": "default", "write_json": true, "log_file_max_bytes": 10485760, "use_colors": true, "introspect": true, "invocation_command": "dbt run", "show_resource_report": false, "quiet": false, "static_parser": true, "enable_legacy_logger": false, "project_dir": "/home/derek/Desktop/dbt_northwind", "log_level": "info", "select": [], "macro_debugging": false, "partial_parse": true, "vars": {}, "populate_cache": true, "log_format_file": "debug", "printer_width": 80, "log_path": "/home/derek/Desktop/dbt_northwind/logs", "profiles_dir": "/home/derek/.dbt", "cache_selected_only": false}}